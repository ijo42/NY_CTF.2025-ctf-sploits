import base64
import hashlib

from cryptography.hazmat.primitives.asymmetric import x448
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes

rec =  {"type":1,"target":"ReceiveMessage","arguments":[{"id":"tOAtTVtUF9IhFoxS0V4RLw"}]}

client_public_key_base64 = "7HIGJ/GxeuBddyoH8H4OLhTNqTs5k/a/UsMu0C7VZ7SXp3UAzhYip4K8iM74QZwcFRb8s8Vm6Co="
server_private_key_base64 = "sIMEABejjZE9ggRd5CI7OgmU2Xy/PoJrSkhzJaXU99q2tv3sx1d+xhNzPnzPxsAoa4a4/FcHsto="
iv_base64 = "dIRT3sxbzCIwJxsYqfT2BA=="
encrypted_message_base64 = {"type":1,"invocationId":"2","target":"Upload","arguments":["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"]}

# Декодирование base64
client_public_key = base64.b64decode(client_public_key_base64)
iv = base64.b64decode(iv_base64)
encrypted_key = base64.b64decode(server_private_key_base64)
encrypted_message = base64.b64decode(encrypted_message_base64["arguments"][0])

# Генерация приватного ключа сервера (предполагается, что это приватный ключ)
server_private_key = (x448.X448PrivateKey.from_private_bytes(encrypted_key))

# Получение общего секрета
shared_secret = server_private_key.exchange(x448.X448PublicKey.from_public_bytes(client_public_key))

# Расшифровка ключа AES
cipher = Cipher(algorithms.AES(hashlib.sha256(shared_secret).digest()), modes.CBC(iv))
decryptor = cipher.decryptor()
decrypted_message = decryptor.update(encrypted_message) + decryptor.finalize()

with open('data.zip', 'wb') as fp:
    fp.write(decrypted_message)